{"version":"2.1.0","runs":[{"invocations":[{"executionSuccessful":true,"toolExecutionNotifications":[{"descriptor":{"id":"Rule parse error"},"level":"error","message":{"text":"Rule parse error in rule security.semgrep.py-exception-detail-exposure:\n Invalid pattern for Python: Stdlib.Parsing.Parse_error\n----- pattern -----\nexcept Exception as $E:\n  ...\n  return {...$E...}\n- pattern-inside: |\n    def $FUNC(...):\n      ...\n\n----- end pattern -----\n"}}]}],"results":[{"fingerprints":{"matchBasedId/v1":"requires login"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":".github/workflows/ci.yml","uriBaseId":"%SRCROOT%"},"region":{"endColumn":72,"endLine":195,"snippet":{"text":"      - run: |\n          if [ \"${{ github.event.inputs.dry_run }}\" = \"true\" ]; then\n            echo \"DRY RUN: Would promote to ${{ github.event.inputs.promote_version }}\"\n            exit 0\n          fi\n          docker pull ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:staging-latest\n          docker tag ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:staging-latest ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.event.inputs.promote_version }}\n          docker tag ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:staging-latest ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:latest\n          docker push ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.event.inputs.promote_version }}\n          docker push ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:latest"},"startColumn":9,"startLine":186}}}],"message":{"text":"Using variable interpolation `${{...}}` with `github` context data in a `run:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\"."},"properties":{},"ruleId":"yaml.github-actions.security.run-shell-injection.run-shell-injection"},{"fingerprints":{"matchBasedId/v1":"requires login"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"app/main.py","uriBaseId":"%SRCROOT%"},"region":{"endColumn":56,"endLine":61,"snippet":{"text":"        components[schema_name][\"title\"] = \"Deprecated\""},"startColumn":9,"startLine":61}}}],"message":{"text":"–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ vault."},"properties":{},"ruleId":"security.semgrep.py-hardcoded-secret"},{"fingerprints":{"matchBasedId/v1":"requires login"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"app/schemas/orm.py","uriBaseId":"%SRCROOT%"},"region":{"endColumn":30,"endLine":14,"snippet":{"text":"    __tablename__ = \"recipes\""},"startColumn":5,"startLine":14}}}],"message":{"text":"–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ vault."},"properties":{},"ruleId":"security.semgrep.py-hardcoded-secret"},{"fingerprints":{"matchBasedId/v1":"requires login"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"app/schemas/orm.py","uriBaseId":"%SRCROOT%"},"region":{"endColumn":34,"endLine":45,"snippet":{"text":"    __tablename__ = \"ingredients\""},"startColumn":5,"startLine":45}}}],"message":{"text":"–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ vault."},"properties":{},"ruleId":"security.semgrep.py-hardcoded-secret"}],"tool":{"driver":{"name":"Semgrep OSS","rules":[{"defaultConfiguration":{"level":"error"},"fullDescription":{"text":"–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ vault."},"help":{"markdown":"–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ vault.\n\n#### üíé Enable cross-file analysis and Pro rules for free at <a href='https://sg.run/pro'>sg.run/pro</a>","text":"–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ vault.\nüíé Enable cross-file analysis and Pro rules for free at sg.run/pro"},"id":"security.semgrep.py-hardcoded-secret","name":"security.semgrep.py-hardcoded-secret","properties":{"precision":"very-high","tags":["CWE-798: Use of Hard-coded Credentials","HIGH CONFIDENCE","security"]},"shortDescription":{"text":"Semgrep Finding: security.semgrep.py-hardcoded-secret"}},{"defaultConfiguration":{"level":"error"},"fullDescription":{"text":"Using variable interpolation `${{...}}` with `github` context data in a `run:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\"."},"help":{"markdown":"Using variable interpolation `${{...}}` with `github` context data in a `run:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\".\n\n#### üíé Enable cross-file analysis and Pro rules for free at <a href='https://sg.run/pro'>sg.run/pro</a>\n\n<b>References:</b>\n - [Semgrep Rule](https://semgrep.dev/r/yaml.github-actions.security.run-shell-injection.run-shell-injection)\n - [https://docs.github.com/en/actions/learn-github-actions/security-hardening-for-github-actions#understanding-the-risk-of-script-injections](https://docs.github.com/en/actions/learn-github-actions/security-hardening-for-github-actions#understanding-the-risk-of-script-injections)\n - [https://securitylab.github.com/research/github-actions-untrusted-input/](https://securitylab.github.com/research/github-actions-untrusted-input/)\n","text":"Using variable interpolation `${{...}}` with `github` context data in a `run:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\".\nüíé Enable cross-file analysis and Pro rules for free at sg.run/pro"},"helpUri":"https://semgrep.dev/r/yaml.github-actions.security.run-shell-injection.run-shell-injection","id":"yaml.github-actions.security.run-shell-injection.run-shell-injection","name":"yaml.github-actions.security.run-shell-injection.run-shell-injection","properties":{"precision":"very-high","tags":["CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')","HIGH CONFIDENCE","OWASP-A01:2017 - Injection","OWASP-A03:2021 - Injection","security"]},"shortDescription":{"text":"Semgrep Finding: yaml.github-actions.security.run-shell-injection.run-shell-injection"}}],"semanticVersion":"1.144.1"}}}],"$schema":"https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/schemas/sarif-schema-2.1.0.json"}
